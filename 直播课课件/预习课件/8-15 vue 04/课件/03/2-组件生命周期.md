# Vue 基础 - 组件生命周期

[toc]

## 1、组件生命周期

组件生命周期指的是组件从创建到销毁的过程，在这个过程中的一些不同的阶段，`vue` 会调用指定的一些组件方法。

基本生命周期函数有下面几个阶段：

- 创建阶段
- 挂载阶段
- 更新阶段
- 卸载阶段
- 其它

每一个阶段都对应着 `之前` 和 `之后` 两个函数。

![lifecycle](./assets/lifecycle.png)



## 2、创建阶段

### 2-1、beforeCreate()

在实例初始化之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用。初始化阶段，应用不多。

### 2-2、created()

在实例创建完成后被立即调用。在这一步，实例已完成以下的配置：数据观测 (data observer)，property 和方法的运算，watch/event 事件回调。然而，挂载阶段还没开始，`$el` property 目前尚不可用。



## 3、挂载阶段

### 3-1、beforeMount()

在挂载开始之前被调用：相关的 `render` 函数首次被调用。

### 3-2、mounted()

该阶段执行完了模板解析，以及挂载。同时组件根组件元素被赋给了 `$el` 属性，该阶段可以通过 <u>DOM</u> 操作来对组件内部元素进行处理了。



## 4、更新阶段

### 4-1、beforeUpdate()

数据更新时调用，但是还没有对视图进行重新渲染，这个时候，可以获取视图更新之前的状态。

### 4-2、updated()

由于数据的变更导致的视图重新渲染，可以通过 <u>DOM</u> 操作来获取视图的最新状态。



## 5、卸载阶段

### 5-1、beforeDestroy()

实例销毁之前调用，移除一些不必要的冗余数据，比如定时器。

### 5-2、destroyed()

Vue 实例销毁后调用。



## 6、其它

### 6-1、.$nextTick()

将回调延迟到下次 DOM 更新循环之后执行。在修改数据之后立即使用它，然后等待 DOM 更新。它跟全局方法 `Vue.nextTick` 一样，不同的是回调的 `this` 自动绑定到调用它的实例上。

与 `updated` 有些类似，`this.$nextTick()` 可以用作局部的数据更新后DOM更新结束后的操作，全局的可以用 `updated` 生命周期函数。

### 6-2、errorCaptured()

当捕获一个来自子孙组件的错误时被调用，此钩子会收到三个参数：错误对象、发生错误的组件实例以及一个包含错误来源信息的字符串。此钩子可以返回 `false` 以阻止该错误继续向上传播。



## 7、生命周期的一些使用场景

**created：**进行ajax请求异步数据的获取、初始化数据

**mounted：**挂载元素dom节点的获取

**$nextTick：**针对单一事件更新数据后立即操作dom

**updated：**任何数据的更新



