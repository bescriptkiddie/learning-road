# Vue 基础 - 可复用的UI组件

[toc]

## 1、自定义指令

我们还可以通过 `Vue` 提供的方法来自定义指令。

### 1-1、注册指令

`vue` 提供了两种指令注册方式

- 全局指令
- 局部指令

### 1-2、全局指令注册

```js
Vue.directive('指令名称', {指令配置});
```

### 1-3、局部指令注册

```js
new Vue({
  el: '#app',
  directives: {
    '指令名称': {指令配置}
  }
});
```

> 在使用指令的时候，需要使用 `v-指令名称` 的方式来调用，注册的时候不需要。

### 1-4、指令生命周期（钩子函数）

指令的运行方式很简单，它提供了一组指令生命周期钩子函数，我们只需要在不同的生命周期钩子函数中进行逻辑处理就可以了

- <u>bind</u> : 只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置
- <u>inserted</u> : 被绑定元素插入父节点时调用 (仅保证父节点存在，但不一定已被插入文档中)
- <u>update</u> : 所在组件更新的时候调用（但是可能发生在其子 VNode 更新之前）。
- <u>componentUpdated</u> : 所在组件及其子组件更新完成后调用
- <u>unbind</u> : 只调用一次，指令与元素解绑时调用

不同的生命周期钩子函数在调用的时候同时会接收到传入的一些不同的参数

- <u>el</u> : 指令所绑定的元素，可以用来直接操作 DOM
- <u>binding</u> : 一个对象，包含以下属性：
  - <u>name</u> : 指令名，不包括 `v-` 前缀
  - <u>value</u> : 指令的绑定值（作为表达式解析后的结果）
  - <u>expression</u> : 指令绑定的表达式（字符串）
  - <u>arg</u> : 传给指令的参数，可选
  - <u>modifiers</u> : 传给指令的修饰符组成的对象，可选，每个修饰符对应一个布尔值
  - <u>oldValue</u> : 指令绑定的前一个值，仅在 <u>update</u> 和 <u>componentUpdated</u> 钩子中可用，无论值是否改变都可用

### 1-5、案例：自定义拖拽指令